<!doctype html><html lang="ru" prefix="og: https://ogp.me/ns#"><head><meta name="viewport" content="width=device-width,initial-scale=1"><meta charset="utf-8"><title>Пример поста № 3 – Кирилл Шмелёв</title><meta name="description" content="Описание поста"><meta name="author" content="mitorun.studio"><meta name="generator" content="Eleventy"><link rel="stylesheet" href="/kirshmelev.ru/styles.css"><link rel="icon" sizes="any" href="/kirshmelev.ru/favicon.ico"><link rel="icon" type="image/svg+xml" href="/kirshmelev.ru/img/favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="/kirshmelev.ru/img/apple-touch-icon.png"><link rel="manifest" href="/kirshmelev.ru/manifest.json"><link rel="preload" as="image" href="/kirshmelev.ru/img/sprite.svg">
	<!-- Yandex.Metrika counter -->
	<!--<script type="text/javascript"></script>-->
	<!-- /Yandex.Metrika counter -->
	<meta property="og:type" content="website"><meta property="og:title" content="Пример поста №3"><meta property="og:description" content="Описание поста"><meta property="og:site_name" content="Кирилл Шмелёв"><meta property="og:locale" content="ru"><meta property="og:image" content="https://v1.screenshot.11ty.dev/https%3A%2F%2Fmitorun-studio.github.io%2Fkirshmelev.ru%2F%2Fblog%2Flayout-vba-interfaces%2F/opengraph/bigger/"><meta property="og:url" content="https://mitorun-studio.github.io/blog/layout-vba-interfaces/"><link rel="canonical" href="https://mitorun-studio.github.io/blog/layout-vba-interfaces/"></head><body class="page-post"><header class="header container"><a class="header__brand" href="/kirshmelev.ru/">Кирилл Шмелёв</a><nav class="header__nav offcanvas" id="offcanvasNavbar" tabindex="-1"><button class="header__button header__button--cross" type="button" data-bs-dismiss="offcanvas" aria-label="Закрыть меню"></button><ul class="menu"><li><a class="menu__link" href="/kirshmelev.ru/">Главная</a></li><li><a class="menu__link" href="/kirshmelev.ru/achievements/">Достижения</a></li><li><a class="menu__link" href="/kirshmelev.ru/partnership/">Сотрудничество</a></li><li><a class="menu__link" href="/kirshmelev.ru/resume/">Резюме</a></li><li><a class="menu__link active" href="/kirshmelev.ru/blog/">Блог</a></li></ul><div class="header__contacts"><a class="header__link" href="tel:+79955373514">+7 995 537-35-14</a></div></nav><button class="header__button" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Открыть меню"></button></header><main class="main" id="main" tabindex="-1"><section class="container page-post__section"><div class="post-head"><h1>Пример поста № 3</h1><div class="post-author"><time datetime="2023-04-20">20 апреля 2023</time><address>Кирилл Шмелёв</address></div></div><div class="post-content"><h1>Вёрстка интерфейсов пользовательских форм в продуктах Microsoft с помощью Visual Basic for Application</h1><h2>Вступление (писала неиросеть)</h2><p>Сегодня я хочу поделиться с вами моим опытом работы с VBA (Visual Basic for Applications) в продуктах Microsoft Office, таких как Excel, Word, Access и PowerPoint. Если вы уже знакомы с VBA и хотите расширить свои навыки, то эта статья для вас! Мы сфокусируемся на вёрстке интерфейсов пользовательских форм с помощью кода, а не графического редактора, что позволит адаптировать интерфейс и автоматизировать рутинные задачи.</p><p>В статье мы рассмотрим настройку пользовательских форм и элементов управления, таких как текстовые поля, кнопки и выпадающие списки, при помощи кода VBA. Благодаря программированию на VBA, вы сможете динамически изменять внешний вид и функциональность форм "на лету", что делает ваш интерфейс более гибким и пригодным для различных задач.</p><p>Также я хотел бы обратить ваше внимание на то, что VBA доступен для пользователей с ограниченными возможностями, например, для слепых пользователей. Работа с VBA предоставляет им возможность создавать и настраивать пользовательские формы без обращения к графическому редактору, который несовместим с программами чтения с экрана.</p><p>Надеюсь, эта статья будет для вас полезной, поможет улучшить ваши навыки в создании пользовательского интерфейса в приложениях Microsoft Office с использованием языка VBA и расширит возможности вашего повседневного инструментария. Желаю вам приятного чтения и успехов в изучении мира VBA!</p><h2>Лирическое отступление</h2><p>Статья предназначена для тех, кто уже немного знаком с VBA, понимает, что такое процидура и как изменять свойства объектов. Я пишу её потому, что мне самому такая статья сильно бы упростила жизнь ещё 2 месяца назад.</p><h2>Добавление элемента управления на форму</h2><p>Для того, чтобы добавить элемент на форму с помощью кода, нам необходимо:</p><h2>1. Инициализировать переменную объекта с соответстуующим типом</h2><p>Для всех элементов управления можно использовать тип Control, но он не поддерживаеет отправку событий (вы не сможете реагировать на взаимодействие с ним). Выглядеть это будет так:</p><pre><code class="language-VBA">Dim MyElement As Control
</code></pre><p>Я же, вместе с официальной документацией Microsoft, рекомендую использовать для каждого элемента управления соответствующий ему тип (таблица с типами приведена ниже), например:</p><pre><code class="language-VBA">Dim MyCommandButton As CommandButton
</code></pre><p>Для того, чтобы элемент отправлял события, в строку нужно добавить параметр <code>WithEvents</code>. Вот так:</p><pre><code class="language-VBA">Dim WithEvents MyCommandButton As CommandButton
</code></pre><h2>2. С помощью оператора <code>Set</code> и метода <code>Controls.Add</code> добавить элемент управления на форму и присвоить ссылку на него в переменную.</h2><p>Программное (динамическое) создание элементов управления пользовательской формы в VBA осуществляется с помощью метода <code>Controls.Add</code>.</p><h3>Синтаксис</h3><pre><code class="language-VBA">Set [Var] = [Form].Controls.Add("[ProgID]", "[Name]", [Visible])
</code></pre><h3>Описание компонентов метода</h3><ul><li>Var — объектная переменная из первого пункта, которой будет присвоен созданный элемент управления.</li><li>Form — имя пользовательской формы, на которую добавляется элемент управления.</li><li>ProgID — программный идентификатор создаваемого элемента управления.</li><li>Name — необязательный параметр, задающий имя добавляемого элемента управления.</li><li>Visible — необязательный параметр, определяющий видимость создаваемого элемента управления. Может принимать значение True или False.</li></ul><p>ProgID и Name, используемые в выражениях метода <code>Controls.Add</code>, строковые параметры, поэтому, если это не переменные, заключаются в прямые кавычки. Смотрите в примерах.</p><h2>Идентификаторы элементов управления формы</h2><table><thead><tr><th style="text-align:left">Элемент управления</th><th style="text-align:left">Программный идентификатор</th><th style="text-align:left">Тип объекта</th></tr></thead><tbody><tr><td style="text-align:left">CheckBox</td><td style="text-align:left">Forms.CheckBox.1</td><td style="text-align:left">msforms.CheckBox</td></tr><tr><td style="text-align:left">ComboBox</td><td style="text-align:left">Forms.ComboBox.1</td><td style="text-align:left">msforms.ComboBox</td></tr><tr><td style="text-align:left">CommandButton</td><td style="text-align:left">Forms.CommandButton.1</td><td style="text-align:left">CommandButton</td></tr><tr><td style="text-align:left">Frame</td><td style="text-align:left">Forms.Frame.1</td><td style="text-align:left">Frame</td></tr><tr><td style="text-align:left">Image</td><td style="text-align:left">Forms.Image.1</td><td style="text-align:left">Image</td></tr><tr><td style="text-align:left">Label</td><td style="text-align:left">Forms.Label.1</td><td style="text-align:left">msforms.Label</td></tr><tr><td style="text-align:left">ListBox</td><td style="text-align:left">Forms.ListBox.1</td><td style="text-align:left">msforms.ListBox</td></tr><tr><td style="text-align:left">OptionButton</td><td style="text-align:left">Forms.OptionButton.1</td><td style="text-align:left">msforms.OptionButton</td></tr><tr><td style="text-align:left">ScrollBar</td><td style="text-align:left">Forms.ScrollBar.1</td><td style="text-align:left">msforms.ScrollBar</td></tr><tr><td style="text-align:left">SpinButton</td><td style="text-align:left">Forms.SpinButton.1</td><td style="text-align:left">SpinButton</td></tr><tr><td style="text-align:left">TextBox</td><td style="text-align:left">Forms.TextBox.1</td><td style="text-align:left">msforms.TextBox</td></tr><tr><td style="text-align:left">ToggleButton</td><td style="text-align:left">Forms.ToggleButton.1</td><td style="text-align:left">ToggleButton</td></tr></tbody></table></div><a class="button button--center" href="/kirshmelev.ru/blog/">Все публикации</a></section></main><footer class="footer container"><div class="footer__brand"><div><a class="header__brand footer__logo" href="/kirshmelev.ru/">Кирилл Шмелёв</a></div><ul class="footer__brand-info"><li>ИП Шмелёв Кирилл Андреевич</li><li>ИНН: 695004617414</li><li>ОГРНИП: 323695200014973</li></ul><ul class="footer__menu-list"><li><a class="footer__menu-link" href="/kirshmelev.ru/privacy-policy/">Политика конфиденциальности</a></li></ul></div><div class="footer__menu"><div class="footer__menu-group"><div class="footer__menu-title">Контакты</div><ul class="footer__menu-list"><li><a class="footer__menu-link" href="tel:+79955373514">+7 995 537-35-14</a></li><li><a class="footer__menu-link" href="mailto:i@kirshmelev.ru">i@kirshmelev.ru</a></li></ul></div><div class="footer__menu-group"><div class="footer__menu-title">Техническая поддержка</div><ul class="footer__menu-list"><li><a class="footer__menu-link" href="mailto:support@kirshmelev.ru">support@kirshmelev.ru</a></li></ul></div></div><div class="footer__menu footer__menu-social"><div class="footer__menu-group"><div class="footer__menu-title">Блог</div><ul class="footer__menu-list"><li><a class="footer__menu-link" target="_blank" rel="noopener" href="https://t.me/kirshmelev_blog">В Telegram</a></li><li><a class="footer__menu-link" target="_blank" rel="noopener" href="https://vk.com/kirshmelev">В VK</a></li></ul></div><div class="footer__menu-group"><div class="footer__menu-title">Социальные сети</div><ul class="footer__menu-list"><li><a class="footer__menu-link" target="_blank" rel="noopener" href="https://instagram.com/kirshmelev">Instagram</a></li><li><a class="footer__menu-link" target="_blank" rel="noopener" href="https://twitter.com/kirshmelev">Twitter</a></li><li><a class="footer__menu-link" target="_blank" rel="noopener" href="https://tenchat.ru/kirshmelev">TenChat</a></li><li><a class="footer__menu-link" target="_blank" rel="noopener" href="https://github.com/kirshmelev">GitHub</a></li></ul></div></div><div class="footer__copyright"><address>© 2022-2023, Шмелёв Кирилл Андреевич</address><address>Сайт создан в <a target="_blank" href="https://mitorun.studio/">Mitorun Studio</a></address></div></footer><script defer src="/kirshmelev.ru/bootstrap.bundle.min.js"></script><script defer src="/kirshmelev.ru/fslightbox.js"></script><noscript class="noscript">У вас в браузере отключён JavaScript</noscript></body></html>