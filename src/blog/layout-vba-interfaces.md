---
title: 'Пример поста №3'
description: 'Описание поста'
date: 2023-04-20
---

# Вёрстка интерфейсов пользовательских форм в продуктах Microsoft с помощью Visual Basic for Application

## Вступление (писала неиросеть)

Сегодня я хочу поделиться с вами моим опытом работы с VBA (Visual Basic for Applications) в продуктах Microsoft Office, таких как Excel, Word, Access и PowerPoint. Если вы уже знакомы с VBA и хотите расширить свои навыки, то эта статья для вас! Мы сфокусируемся на вёрстке интерфейсов пользовательских форм с помощью кода, а не графического редактора, что позволит адаптировать интерфейс и автоматизировать рутинные задачи.

В статье мы рассмотрим  настройку пользовательских форм и элементов управления, таких как текстовые поля, кнопки и выпадающие списки, при помощи кода VBA. Благодаря программированию на VBA, вы сможете динамически изменять внешний вид и функциональность форм "на лету", что делает ваш интерфейс более гибким и пригодным для различных задач.

Также я хотел бы обратить ваше внимание на то, что VBA доступен для пользователей с ограниченными возможностями, например, для слепых пользователей. Работа с VBA предоставляет им возможность создавать и настраивать пользовательские формы без обращения к графическому редактору, который несовместим с программами чтения с экрана.

Надеюсь, эта статья будет для вас полезной, поможет улучшить ваши навыки в создании пользовательского интерфейса в приложениях Microsoft Office с использованием языка VBA и расширит возможности вашего повседневного инструментария. Желаю вам приятного чтения и успехов в изучении мира VBA!

## Лирическое отступление

Статья предназначена для тех, кто уже немного знаком с VBA, понимает, что такое процидура и как изменять свойства объектов. Я пишу её потому, что мне самому такая статья сильно бы упростила жизнь ещё 2 месяца назад.

## Добавление элемента управления на форму

Для того, чтобы добавить элемент на форму с помощью кода, нам необходимо:

## 1. Инициализировать переменную объекта с соответстуующим типом

Для всех элементов управления можно использовать тип Control, но он не поддерживаеет отправку событий (вы не сможете реагировать на взаимодействие с ним). Выглядеть это будет так:

```VBA
Dim MyElement As Control
```

Я же, вместе с официальной документацией Microsoft, рекомендую использовать для каждого элемента управления соответствующий ему тип (таблица с типами приведена ниже), например:

```VBA
Dim MyCommandButton As CommandButton
```

Для того, чтобы элемент отправлял события, в строку нужно добавить параметр `WithEvents`. Вот так:

```VBA
Dim WithEvents MyCommandButton As CommandButton
```

## 2. С помощью оператора `Set` и метода `Controls.Add` добавить элемент управления на форму и присвоить ссылку на него в переменную.

Программное (динамическое) создание элементов управления пользовательской формы в VBA осуществляется с помощью метода `Controls.Add`.

### Синтаксис

```VBA
Set [Var] = [Form].Controls.Add("[ProgID]", "[Name]", [Visible])
```

### Описание компонентов метода

- Var — объектная переменная из первого пункта, которой будет присвоен созданный элемент управления.
- Form — имя пользовательской формы, на которую добавляется элемент управления.
- ProgID — программный идентификатор создаваемого элемента управления.
- Name — необязательный параметр, задающий имя добавляемого элемента управления.
- Visible — необязательный параметр, определяющий видимость создаваемого элемента управления. Может принимать значение True или False.

ProgID и Name, используемые в выражениях метода `Controls.Add`, строковые параметры, поэтому, если это не переменные, заключаются в прямые кавычки. Смотрите в примерах.

## Идентификаторы элементов управления формы

| Элемент управления | Программный идентификатор | Тип объекта          |
|:-------------------|:--------------------------|:---------------------|
| CheckBox           | Forms.CheckBox.1          | msforms.CheckBox     |
| ComboBox           | Forms.ComboBox.1          | msforms.ComboBox     |
| CommandButton      | Forms.CommandButton.1     | CommandButton        |
| Frame              | Forms.Frame.1             | Frame                |
| Image              | Forms.Image.1             | Image                |
| Label              | Forms.Label.1             | msforms.Label        |
| ListBox            | Forms.ListBox.1           | msforms.ListBox      |
| OptionButton       | Forms.OptionButton.1      | msforms.OptionButton |
| ScrollBar          | Forms.ScrollBar.1         | msforms.ScrollBar    |
| SpinButton         | Forms.SpinButton.1        | SpinButton           |
| TextBox            | Forms.TextBox.1           | msforms.TextBox      |
| ToggleButton       | Forms.ToggleButton.1      | ToggleButton         |

